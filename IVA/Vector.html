<!DOCTYPE html>
<html>
	<head>
		<title>Vector Math Interactive Visualization App</title>
		<style>
canvas, #controls {
	border: 1px solid #000000;
	position: absolute;
}

div {
	position: absolute;
}

#container {
	top:0px;
	left:0px;
	width:100%;
	height:100%;
}

button {

}

.point {
	position: static;
	display: inline-block;
	border: 1px solid #000000;
	height: 80px;
	width: 80px;
}

.point input {
	width: 30px;
}

#drag {
	height: 20px;
	width: 20px;
	border-radius: 11px;
	border: 1px solid #000000;
	display: none;
	pointer-events: none;
}
		</style>
		<script>
//-----------------------------------------------------------------------//


///////////////////////////////////////////////////////////////////////////
//                                 Setup                                 //
///////////////////////////////////////////////////////////////////////////
function loadStuff() {
	W = window.innerWidth;
	H = window.innerHeight;
	p1 = document.getElementById("points");
	p2 = document.getElementById("connects");
	b = document.getElementById("buttons");
	c = document.getElementById("console");
	gr = document.getElementById("graph");
	cr = document.getElementById("controls");
	d = document.getElementById("drag");

	gr.style.top = H * 0.05 + "px";
	gr.style.left = W * 0.05 + "px";
	if(W > H){
		gr.width = W * 0.65;
		gr.height = H * 0.9;
		cr.style.top = H * 0.05 + "px";
		cr.style.right = W * 0.05 + "px";
		cr.style.width = W * 0.15 + "px";
		cr.style.height = H * 0.9 + "px";
		p1.style.top = "20px";
		p1.style.width = W * 0.075 + "px";
		p1.style.height = H * 0.6 + "px";
		p1.style.overflowY = "scroll";
		p2.style.top = "20px";
		p2.style.width = W * 0.075 + "px";
		p2.style.height = H * 0.6 + "px";
		p2.style.overflowY = "scroll";
		p2.style.right = "0px";
		b.style.bottom = "20px";
	}else{
		gr.width = W * 0.9;
		gr.height = H * 0.65;
		cr.style.bottom = H * 0.05 + "px";
		cr.style.left = W * 0.05 + "px";
		cr.style.width = W * 0.9 + "px";
		cr.style.height = H * 0.15 + "px";
		p1.style.height = H * 0.075 + "px";
		p1.style.width = W * 0.6 + "px";
		p1.style.overflowX = "scroll";
		p2.style.height = H * 0.075 + "px";
		p2.style.width = W * 0.6 + "px";
		p2.style.overflowX = "scroll";
		p2.style.bottom = "0px";
		b.style.right = "0px";
		b.style.top = "0px";
		c.style.right = "0px";
	}
	c.style.bottom = "0px";

	drag = -1;


	ctx = gr.getContext("2d");

	points = [];
	connections = 0;
}

function loadGraph() {
	xRange = new Range(points[0].pos.x,points[0].pos.x);
	yRange = new Range(points[0].pos.y,points[0].pos.y);
	for(i=1;i<points.length;i++){
		xRange.a = Math.min(xRange.a,points[i].pos.x);
		xRange.b = Math.max(xRange.b,points[i].pos.x);
		yRange.a = Math.min(yRange.a,points[i].pos.y);
		yRange.b = Math.max(yRange.b,points[i].pos.y);
	}

	ctx.clearRect(0,0,gr.width,gr.height);
	for(i=0;i<points.length;i++){
		scalePoint = new Vector2(xRange.scale(points[i].pos.x)*gr.width,yRange.scale(points[i].pos.y)*gr.height);
		drawPoint(scalePoint);
	}
}


///////////////////////////////////////////////////////////////////////////
//                                Drawing                                //
///////////////////////////////////////////////////////////////////////////

function label(text,x,y){
	//calculate exact location based on gr size
	ctx.fillText(text,x,y);
}

function drawPoint(vector){
	ctx.beginPath();
	ctx.arc(vector.x,vector.y,10,0,2*Math.PI);
	ctx.stroke();
}

function drawLine(line) {
	ctx.moveTo(line.p.x,line.p.y);
	ctx.lineTo(line.r.x,line.r.y);
	ctx.stroke();
}


///////////////////////////////////////////////////////////////////////////
//                                Objects                                //
///////////////////////////////////////////////////////////////////////////

function Range(a,b) {
	this.a = a;
	this.b = b;
	this.min = function(){return Math.min(this.a,this.b);}
	this.max = function(){return Math.max(this.a,this.b);}

	this.scale = function(num){
		if(this.max() == this.min()) return 0;
		return (num - this.min()) / (this.max() - this.min());
	}
}

function Vector2(x,y) {
	this.x = x;
	this.y = y;
}

function Line(p,r) {
	this.p = p;
	this.r = r;
}

function Point(index) {
	this.index = index;
	this.pos = new Vector2(0,0);
	this.connected = -1;

	this.button = document.createElement("div");
	this.button.classList.add("point");
	this.xInput = document.createElement("input");
	this.xInput.value = this.pos.x;
	this.xInput.type="number";
	this.xInput.addEventListener("change",function(){changeValue(index);},false);
	this.button.append(this.xInput);
	this.yInput = document.createElement("input");
	this.yInput.value = this.pos.y;
	this.yInput.type="number";
	this.yInput.addEventListener("change",function(){changeValue(index);},false);
	this.button.append(this.yInput);
	this.button.addEventListener("mousedown",function(){drag=index;},false);
	this.button.addEventListener("mouseover",function(){mouseOver(index);},false);
	this.button.addEventListener("mouseout",function(){mouseOver(-1);},false);
	p1.append(this.button);
}

function Connection(PointA, PointB) {
	this.point = PointA;
	this.connection = PointB;
}


///////////////////////////////////////////////////////////////////////////
//                                Buttons                                //
///////////////////////////////////////////////////////////////////////////

function mouseMove() {
	if(drag >= 0){
		d.style.display="block";
		d.style.left = event.clientX - 10 + "px";
		d.style.top = event.clientY - 10 + "px";
		gr.style.backgroundColor = "#FFFFBB";
		for(child of p1.children){
			child.style.backgroundColor = "#FFFFBB";
		}
		//p2.style.backgroundColor = "#FFFFBB";
	}
	//c.innerHTML = event.clientX+","+event.clientY;
	//c.innerHTML = drag;
	//c.innerHTML = dropTo;
}

function mouseUp() {
	d.style.display = "none";
	gr.style.backgroundColor = "#FFFFFF";
	for(child of p1.children){
		child.style.backgroundColor = "#FFFFFF";
	}
	//p2.style.backgroundColor = "#FFFFFF";

	if(dropTo == "canvas"){
		
	}else if(dropTo == "points"){
		if(points[drag].connected >= 0){
			points[drag].connected = -1;
			points[points[drag].connected].connected = -1;
		}
	}else if(dropTo >= 0){
		if(points[drag].connected >= 0){
			points[points[drag].connected].connected = -1;
		}
		points[drag].connected = dropTo;
		points[dropTo].connected = drag;
	}
	
	if(dropTo >= 0){
		index = Array.prototype.indexOf.call(p1,points[drag].button);
		c.innerHTML = drag + " is connected with " + dropTo + "--"+index;
	}
	drag = -1;
}

function mouseOver(which) {
	dropTo=which;
	event.stopPropagation();
}


///////////////////////////////////////////////////////////////////////////
//                                Buttons                                //
///////////////////////////////////////////////////////////////////////////

function addPoint() {
	points[points.length]=new Point(points.length);
	loadGraph();
}

function connectPoints() {

}

function changeValue(index) {
	points[index].pos = new Vector2(points[index].xInput.value,points[index].yInput.value);
	loadGraph();
}

//-----------------------------------------------------------------------//
		</script>
	</head>
	<body onload="loadStuff()" onmousemove="mouseMove()" onmouseup="mouseUp()" onselectstart="return false">
		<div id="container">
			<canvas id="graph" onmouseover="mouseOver('canvas')" onmouseout="mouseOver(-1)"></canvas>
			<div id="controls">
				<center>Points:</center>
				<div id="points" onmouseover="mouseOver('points')" onmouseout="mouseOver(-1)"></div>
				<div id="connects"></div>
				<div id="buttons">
					<button id="addpoint" onclick="addPoint()">Add Point</button>
					<button id="connectpoints" onclick="connectPoints()">Connect Points</button>
				</div>
				<div id="console"></div>
			</div>
			<div id="drag"></div>
		</div>
	</body>
</html>